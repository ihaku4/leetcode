#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <string.h>
#include <limits.h>

int numDecodings_Wrong(char* s) {
    int count = 1;

    if (!s || !*s || '0' == *s) return 0;

    for (; *s; s++) {
        if      ('\0' == *(s + 1))                            continue;
        else if ('0' == *(s + 1)) if ('1' == *s || '2' == *s) continue;
                                  else                        return 0;
        else if ('1' == *(s + 1) && '0' == *(s + 2))          continue;
        else if ('2' == *(s + 1) && '0' == *(s + 2))          continue;
        else if ('1' == *s)                                   count++;
        else if ('2' == *s && *(s + 1) - '7' < 0)             count++;
     }
    return count;
}

int numDecodings_Helper(char *s) {
    if ('\0' == *s )
        return 1;
    else if ('0' == *s)
        return 0;
    else if ('1' == *s) {
        if ('\0' != *(s + 1))
            return numDecodings_Helper(s + 1) + numDecodings_Helper(s + 2);
        else
            return numDecodings_Helper(s + 1);
    }
    else if ('2' == *s) {
        if ('0' == *(s + 1) ||
            '1' == *(s + 1) ||
            '2' == *(s + 1) ||
            '3' == *(s + 1) ||
            '4' == *(s + 1) ||
            '5' == *(s + 1) ||
            '6' == *(s + 1)) {
            return numDecodings_Helper(s + 1) + numDecodings_Helper(s + 2);
        }
        else
            return numDecodings_Helper(s + 1);
    }
    else 
        return numDecodings_Helper(s + 1);
}

int numDecodings_Slow(char *s) {
    if (*s) return numDecodings_Helper(s);
    else    return 0;
}

int numDecodings(char *s) {
    char *p;
    int pre, cur, next;

    if ('\0' == *s) return 0;
    if ('\0' == *(s + 1)) if ('0' == *s) return 0;
                          else           return 1;

    pre = 1;
    p = s + 2;

    if      ('0' == *(p - 2)) { return 0; }

    else if ('1' == *(p - 2)) { if ('0' == *(p - 1))      cur = pre;       // 0
                                else                      cur = pre + pre; // 1-9
    }
    else if ('2' == *(p - 2)) { if      ('0' == *(p - 1)) cur = pre;       // 0
                                else if ('6' < *(p - 1))  cur = pre;       // 789
                                else                      cur = pre + pre; // 1-6
    }
    else /*      3 - 9    */  { if      ('0' == *(p - 1)) return 0;
                                else                      cur = pre;
    }

    for (; *p; p++) {

        if ('0' == *p) { if ('1' == *(p - 1) || '2' == *(p - 1))     next = pre;
                         else                                        return 0;
        }
        else {           if      ('1' == *(p - 1))                   next = cur + pre;
                         else if ('2' == *(p - 1)) { if ('6' < *p)   next = cur;
                                                     else            next = cur + pre;
                         }
                         else                                        next = cur;
        }

        pre = cur;
        cur = next;
    }
    return cur;
}

int main(int argc, char *argv[])
{
    printf("%d\n\n", '8' > '7');
    printf("%d\n", numDecodings("301"));
    printf("%d\n", numDecodings("12"));
    printf("%d\n", numDecodings("1212"));
    printf("%d\n", numDecodings("4673351343232714528787622144828949686814115978657763689251918941228645575658338815495647817194659920"));
    /* printf("%d\n", numDecodings("101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010")); */
    return 0;
}
